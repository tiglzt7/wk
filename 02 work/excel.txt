Sub ExtractLeftEightCharacters()
    Dim rng As Range
    Dim cell As Range

    '選択範囲を取得
    Set rng = Application.Selection

    '各セルに対して処理を実行
    For Each cell In rng
        'セルの値を文字列に変換し、左から8文字を取得
        cell.Value = Left(CStr(cell.Value), 8)
    Next cell
End Sub


Sub ZeroPaddingToEightCharacters()
    Dim rng As Range
    Dim cell As Range

    '選択範囲を取得
    Set rng = Application.Selection

    '各セルに対して処理を実行
    For Each cell In rng
        'セルの書式を文字列に設定
        cell.NumberFormat = "@"
        'セルの値を文字列に変換し、左側を0で埋めて8桁にする
        cell.Value = Right("00000000" & CStr(cell.Value), 8)
    Next cell
End Sub


Sub ZeroPaddingToElevenCharacters()
    Dim rng As Range
    Dim cell As Range

    '選択範囲を取得
    Set rng = Application.Selection

    '各セルに対して処理を実行
    For Each cell In rng
        'セルの書式を文字列に設定
        cell.NumberFormat = "@"
        'セルの値を文字列に変換し、右側を0で埋めて11桁にする
        cell.Value = Left(CStr(cell.Value) & "00000000000", 11)
    Next cell
End Sub


Sub CombineSelectedColumns()

    ' 選択された範囲を取得
    Dim rng As Range
    Set rng = Selection

    ' 最初の選択範囲の開始行を取得
    Dim startRow As Long
    startRow = rng.Areas(1).Row

    ' 結果を格納する新しい列を作成
    Dim resultCol As Range
    Set resultCol = rng.Parent.Cells(startRow, rng.Parent.Columns.Count).End(xlToLeft).Offset(0, 1)

    Dim rowIdx As Long
    For rowIdx = 1 To rng.Rows.Count
        Dim combinedValue As String
        combinedValue = ""

        ' 選択範囲の各領域に対してループを実行
        Dim area As Range
        For Each area In rng.Areas
            
            Dim colIdx As Long
            For colIdx = 1 To area.Columns.Count
                ' 選択された列の値を結合
                combinedValue = combinedValue & area.Cells(rowIdx, colIdx).Value
            Next colIdx

        Next area

        ' 結果を新しい列に書き込む
        resultCol.Cells(rowIdx, 1).Value = combinedValue
    Next rowIdx

End Sub